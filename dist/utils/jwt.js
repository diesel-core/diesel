function F(z,A){if(!z)throw new Error("JWT library is not defined, please provide jwt to authenticateJwt Function");return(v)=>{try{let f=v.cookies?.accessToken||v.req?.headers?.get("Authorization");if(!f)return v.json({message:"Unauthorized: No token provided"},401);if(f.startsWith("Bearer "))f=f.slice(7);let q=z?.verify(f,A);if(!q)return v.json({message:"Unauthorized: Invalid token"},401);v.set("user",q)}catch(f){return console.error("JWT verification error:",f),v.json({message:"Unauthorized: Invalid token",error:f?.message},401)}}}function G(z,A,v){if(!z)throw new Error("JWT library is not defined, please provide jwt to authenticateJwtDB Function");if(!A)throw new Error("User model is not defined, please provide UserModel to authenticateJwtDB Function");return async(f)=>{try{let q=f.cookies?.accessToken||f.req?.headers?.get("Authorization");if(!q)return f.json({message:"Unauthorized: No token provided"},401);if(q.startsWith("Bearer "))q=q.slice(7);let C=z?.verify(q,v);if(!C)return f.json({message:"Unauthorized: Invalid token"},401);let E=await A.findById(C._id).select("-password -refreshToken");if(!E)return f.json({message:"Unauthorized: User not found"},401);f.set("user",E);return}catch(q){return f.json({message:"Unauthorized: Authentication failed",error:q?.message},401)}}}export{F as authenticateJwtMiddleware,G as authenticateJwtDbMiddleware};
