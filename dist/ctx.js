var _=Object.create;var{getPrototypeOf:M,defineProperty:R,getOwnPropertyNames:w}=Object;var H=Object.prototype.hasOwnProperty;var Q=(E,F,K)=>{K=E!=null?_(M(E)):{};let z=F||!E||!E.__esModule?R(K,"default",{value:E,enumerable:!0}):K;for(let J of w(E))if(!H.call(z,J))R(z,J,{get:()=>E[J],enumerable:!0});return z};var B=((E)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(E,{get:(F,K)=>(typeof require!=="undefined"?require:F)[K]}):E)(function(E){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+E+'" is not supported')});function C(E){let{time:F=60000,max:K=100,message:z="Rate limit exceeded. Please try again later."}=E,J=new Map;return(Y)=>{let X=new Date,$=Y.ip;if(!J.has($))J.set($,{count:0,startTime:X});let Z=J.get($);if(Z)if(X-Z.startTime>F)Z.count=1,Z.startTime=X;else Z.count++;if(Z&&Z.count>K)return Y.json({error:z},429)}}function V(E){switch(E.split(".").pop()?.toLowerCase()){case"js":return"application/javascript";case"css":return"text/css";case"html":return"text/html";case"json":return"application/json";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"svg":return"image/svg+xml";case"gif":return"image/gif";case"woff":return"font/woff";case"woff2":return"font/woff2";default:return"application/octet-stream"}}var U=(E,F,K,z)=>{if(K>z)return!1;let J=K+(z-K)/2;if(E[J]==F)return!0;if(E[J]>F)return U(E,F,K,J-1);return U(E,F,J+1,z)};function D(E,F,K){let z=new Headers({"Cache-Control":"no-cache"}),J=null,Y=null,X=null,$=null,Z={};return{req:E,server:F,url:K,setHeader(A,O){return z.set(A,O),this},removeHeader(A){return z.delete(A),this},get ip(){return this.server.requestIP(this.req)?.address??null},get query(){if(!J)try{J=Object.fromEntries(this.url.searchParams)}catch(A){throw new Error("Failed to parse query parameters")}return J},get params(){if(!Y&&this.req.routePattern)try{Y=j(this.req.routePattern,this.url.pathname)}catch(A){throw new Error("Failed to extract route parameters")}return Y??{}},get body(){if(this.req.method==="GET")return Promise.resolve({});if(!$)$=(async()=>{let A=await x(this.req);if(A.error)throw new Error(A.error);return Object.keys(A).length===0?null:A})();return $},set(A,O){return Z[A]=O,this},get(A){return Z[A]},text(A,O=200){if(!z.has("Content-Type"))z.set("Content-Type","text/plain; charset=utf-8");return new Response(A,{status:O,headers:z})},send(A,O=200){let G=new Map([["string","text/plain; charset=utf-8"],["object","application/json; charset=utf-8"],["Uint8Array","application/octet-stream"],["ArrayBuffer","application/octet-stream"]]),L=A instanceof Uint8Array?"Uint8Array":A instanceof ArrayBuffer?"ArrayBuffer":typeof A;if(!z.has("Content-Type"))z.set("Content-Type",G.get(L)??"text/plain; charset=utf-8");let N=L==="object"&&A!==null?JSON.stringify(A):A;return new Response(N,{status:O,headers:z})},json(A,O=200){if(!z.has("Content-Type"))z.set("Content-Type","application/json; charset=utf-8");return new Response(JSON.stringify(A),{status:O,headers:z})},file(A,O=200,G){let L=Bun.file(A);if(!z.has("Content-Type"))z.set("Content-Type",G??V(A));return new Response(L,{status:O,headers:z})},async ejs(A,O={}){let G;try{G=await import("ejs"),G=G.default||G}catch(L){return console.error("EJS not installed! Please run `bun add ejs`"),new Response("EJS not installed! Please run `bun add ejs`",{status:500})}try{let L=await Bun.file(A).text(),N=G.render(L,O),W=new Headers({"Content-Type":"text/html; charset=utf-8"});return new Response(N,{status:200,headers:W})}catch(L){return console.error("EJS Rendering Error:",L),new Response("Error rendering template",{status:500})}},redirect(A,O=302){return z.set("Location",A),new Response(null,{status:O,headers:z})},setCookie(A,O,G={}){let L=`${encodeURIComponent(A)}=${encodeURIComponent(O)}`;if(G.maxAge)L+=`; Max-Age=${G.maxAge}`;if(G.expires)L+=`; Expires=${G.expires.toUTCString()}`;if(G.path)L+=`; Path=${G.path}`;if(G.domain)L+=`; Domain=${G.domain}`;if(G.secure)L+="; Secure";if(G.httpOnly)L+="; HttpOnly";if(G.sameSite)L+=`; SameSite=${G.sameSite}`;return z.append("Set-Cookie",L),this},get cookies(){if(!X){let A=this.req.headers.get("cookie");X=A?b(A):{}}return X}}}function b(E){return Object.fromEntries(E.split(";").map((F)=>{let[K,...z]=F.trim().split("=");return[K,decodeURIComponent(z.join("="))]}))}function j(E,F){let K={},z=E.split("/"),[J]=F.split("?"),Y=J.split("/");if(z.length!==Y.length)return null;for(let X=0;X<z.length;X++)if(z[X].startsWith(":"))K[z[X].slice(1)]=Y[X];return K}async function x(E){let F=E.headers.get("Content-Type");if(!F)return{};if(E.headers.get("Content-Length")==="0"||!E.body)return{};try{if(F.startsWith("application/json"))return await E.json();if(F.startsWith("application/x-www-form-urlencoded")){let z=await E.text();return Object.fromEntries(new URLSearchParams(z))}if(F.startsWith("multipart/form-data")){let z=await E.formData(),J={};for(let[Y,X]of z.entries())J[Y]=X;return J}return{error:"Unknown request body type"}}catch(z){return{error:"Invalid request body format"}}}export{D as default};
