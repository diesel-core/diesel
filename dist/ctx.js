function N(G){switch(G.split(".").pop()?.toLowerCase()){case"js":return"application/javascript";case"css":return"text/css";case"html":return"text/html";case"json":return"application/json";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"svg":return"image/svg+xml";case"gif":return"image/gif";case"woff":return"font/woff";case"woff2":return"font/woff2";default:return"application/octet-stream"}}function U(G,K,Y){let A=new Headers({"Cache-Control":"no-cache"}),O=null,X=null,L=null,Z=null,$={};return{req:G,server:K,url:Y,setHeader(z,F){return A.set(z,F),this},removeHeader(z){return A.delete(z),this},get ip(){return this.server.requestIP(this.req)?.address??null},get query(){if(!O)try{O=Object.fromEntries(this.url.searchParams)}catch(z){throw new Error("Failed to parse query parameters")}return O},get params(){if(!X&&this.req.routePattern)try{X=W(this.req.routePattern,this.url.pathname)}catch(z){throw new Error("Failed to extract route parameters")}return X??{}},get body(){if(!Z)Z=(async()=>{let z=await j(this.req);if(z.error)throw new Error(z.error);return Object.keys(z).length===0?null:z})();return Z},set(z,F){return $[z]=F,this},get(z){return $[z]},text(z,F=200){if(!A.has("Content-Type"))A.set("Content-Type","text/plain; charset=utf-8");return new Response(z,{status:F,headers:A})},send(z,F=200){let E=new Map([["string","text/plain; charset=utf-8"],["object","application/json; charset=utf-8"],["Uint8Array","application/octet-stream"],["ArrayBuffer","application/octet-stream"]]),J=z instanceof Uint8Array?"Uint8Array":z instanceof ArrayBuffer?"ArrayBuffer":typeof z;if(!A.has("Content-Type"))A.set("Content-Type",E.get(J)??"text/plain; charset=utf-8");let R=J==="object"&&z!==null?JSON.stringify(z):z;return new Response(R,{status:F,headers:A})},json(z,F=200){if(!A.has("Content-Type"))A.set("Content-Type","application/json; charset=utf-8");return new Response(JSON.stringify(z),{status:F,headers:A})},file(z,F=200,E){let J=Bun.file(z);if(!A.has("Content-Type"))A.set("Content-Type",E??N(z));return new Response(J,{status:F,headers:A})},redirect(z,F=302){return A.set("Location",z),new Response(null,{status:F,headers:A})},setCookie(z,F,E={}){let J=`${encodeURIComponent(z)}=${encodeURIComponent(F)}`;if(E.maxAge)J+=`; Max-Age=${E.maxAge}`;if(E.expires)J+=`; Expires=${E.expires.toUTCString()}`;if(E.path)J+=`; Path=${E.path}`;if(E.domain)J+=`; Domain=${E.domain}`;if(E.secure)J+="; Secure";if(E.httpOnly)J+="; HttpOnly";if(E.sameSite)J+=`; SameSite=${E.sameSite}`;return A.append("Set-Cookie",J),this},get cookies(){if(!L){let z=this.req.headers.get("cookie");L=z?V(z):{}}return L}}}function V(G){return Object.fromEntries(G.split(";").map((K)=>{let[Y,...A]=K.trim().split("=");return[Y,decodeURIComponent(A.join("="))]}))}function W(G,K){let Y={},A=G.split("/"),[O]=K.split("?"),X=O.split("/");if(A.length!==X.length)return null;for(let L=0;L<A.length;L++)if(A[L].startsWith(":"))Y[A[L].slice(1)]=X[L];return Y}async function j(G){let K=G.headers.get("Content-Type");if(!K)return{};if(G.headers.get("Content-Length")==="0"||!G.body)return{};try{if(K.startsWith("application/json"))return await G.json();if(K.startsWith("application/x-www-form-urlencoded")){let A=await G.text();return Object.fromEntries(new URLSearchParams(A))}if(K.startsWith("multipart/form-data")){let A=await G.formData(),O={};for(let[X,L]of A.entries())O[X]=L;return O}return{error:"Unknown request body type"}}catch(A){return{error:"Invalid request body format"}}}export{U as default};
