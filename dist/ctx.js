function R(F){switch(F.split(".").pop()?.toLowerCase()){case"js":return"application/javascript";case"css":return"text/css";case"html":return"text/html";case"json":return"application/json";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"svg":return"image/svg+xml";case"gif":return"image/gif";case"woff":return"font/woff";case"woff2":return"font/woff2";default:return"application/octet-stream"}}function V(F,J,Y){let A=new Headers({"Cache-Control":"no-cache"}),O=null,X=null,K,Z,N={};return{req:F,server:J,url:Y,setHeader(z,E){return A.set(z,E),this},removeHeader(z){return A.delete(z),this},get ip(){return this.server.requestIP(this.req)?.address??null},get query(){if(!O)try{O=Object.fromEntries(this.url.searchParams)}catch(z){throw new Error("Failed to parse query parameters")}return O},get params(){if(!K&&this.req.routePattern)try{K=j(this.req.routePattern,this.url.pathname)}catch(z){throw new Error("Failed to extract route parameters")}return K??{}},get body(){if(!Z)Z=(async()=>{let z=await w(this.req);if(z.error)throw new Error(z.error);if(z.error)throw new Error(z.error);return z})();return Z},set(z,E){return N[z]=E,this},get(z){return N[z]},text(z,E){if(!A.has("Content-Type"))A.set("Content-Type","text/plain; charset=utf-8");return new Response(z,{status:E,headers:A})},send(z,E){if(typeof z==="string"){if(!A.has("Content-Type"))A.set("Content-Type","text/plain; charset=utf-8")}else if(typeof z==="object"){if(!A.has("Content-Type"))A.set("Content-Type","application/json; charset=utf-8");z=JSON.stringify(z)}else if(z instanceof Uint8Array||z instanceof ArrayBuffer){if(!A.has("Content-Type"))A.set("Content-Type","application/octet-stream")}return new Response(z,{status:E,headers:A})},json(z,E){if(!A.has("Content-Type"))A.set("Content-Type","application/json; charset=utf-8");return new Response(JSON.stringify(z),{status:E,headers:A})},file(z,E=200,G){let L=R(z),U=Bun.file(z),$=new Headers;if(!$.has("Content-Type"))$.set("Content-Type",G??L);return new Response(U,{status:E,headers:$})},redirect(z,E){return A.set("Location",z),new Response(null,{status:E??302,headers:A})},setCookie(z,E,G={}){let L=`${encodeURIComponent(z)}=${encodeURIComponent(E)}`;if(G.maxAge)L+=`; Max-Age=${G.maxAge}`;if(G.expires)L+=`; Expires=${G.expires.toUTCString()}`;if(G.path)L+=`; Path=${G.path}`;if(G.domain)L+=`; Domain=${G.domain}`;if(G.secure)L+="; Secure";if(G.httpOnly)L+="; HttpOnly";if(G.sameSite)L+=`; SameSite=${G.sameSite}`;return A?.append("Set-Cookie",L),this},get cookies(){if(!X){let z=this.req.headers.get("cookie");if(z)X=W(z);else return{}}return X}}}function W(F){return Object.fromEntries(F.split(";").map((J)=>{let[Y,...A]=J.trim().split("=");return[Y,decodeURIComponent(A.join("="))]}))}function j(F,J){let Y={},A=F.split("/"),[O]=J.split("?"),X=O.split("/");if(A.length!==X.length)return null;for(let K=0;K<A.length;K++)if(A[K].startsWith(":"))Y[A[K].slice(1)]=X[K];return Y}async function w(F){let J=F.headers.get("Content-Type");if(!J)return{};if(F.headers.get("Content-Length")==="0"||!F.body)return{};try{if(J.startsWith("application/json"))return await F.json();if(J.startsWith("application/x-www-form-urlencoded")){let A=await F.text();return Object.fromEntries(new URLSearchParams(A))}if(J.startsWith("multipart/form-data")){let A=await F.formData(),O={};for(let[X,K]of A.entries())O[X]=K;return O}return{error:"Unknown request body type"}}catch(A){return{error:"Invalid request body format"}}}export{V as default};
