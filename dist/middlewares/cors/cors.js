var d=["GET","POST","PUT","DELETE","OPTIONS"],g=["Content-Type","Authorization"],A=(o)=>{return async function(e){let s=e.req.headers.get("origin")??"*";console.log("origin",s);let r=o.origin,t=o.allowedHeaders??g,i=o.methods??d,a=o.credentials??!1,n=o.exposedHeaders??[],l=o.maxAge;if(e.setHeader("Access-Control-Allow-Methods",i.join(",")),e.setHeader("Access-Control-Allow-Headers",t.join(",")),e.setHeader("Access-Control-Allow-Credentials",a.toString()),n.length>0)e.setHeader("Access-Control-Expose-Headers",n.join(","));if(r==="*"||s==="*")e.setHeader("Access-Control-Allow-Origin","*");else if(Array.isArray(r))if(s&&r.includes(s))e.setHeader("Access-Control-Allow-Origin",s);else if(r.includes("*"))e.setHeader("Access-Control-Allow-Origin","*");else return e.json({message:"CORS not allowed"},403);else if(typeof r==="string")if(s===r)e.setHeader("Access-Control-Allow-Origin",s);else return e.json({message:"CORS not allowed"},403);else return e.json({message:"CORS not allowed"},403);if(e.req.method==="OPTIONS"){if(l)e.setHeader("Access-Control-Max-Age",l.toString());return e.text("",204)}return null}};export{A as cors};
